<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ProtectUs</title>
    <link rel="shortcut icon" type="image/png" href="/logo.png" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>

<body class="bg-[#515F84] text-white flex flex-col justify-center items-center h-screen">
    <!-- Back button -->
    <!-- Link to the profile page -->
    <a href="/profile">
        <span
            class="material-symbols-outlined absolute top-0 left-0 mt-4 ml-4 inline-block px-3 py-1 bg-[#515F84] rounded-lg text-[#EAD797]">
            arrow_back_ios
        </span>
    </a>
    <br />
    <br />
    <br />
    <img src="logo.png" alt="" class="w-[300px] h-[300px] justify-center" />
    <div class="max-w-md mx-auto bg-[#EAD797] rounded-lg p-8 shadow-[0_0px_10px_0px_rgba(0,0,0,0.5)] mb-8"
        style="width: 350px">
        <!-- Password change form -->
        <h2 class="text-2xl mb-4 text-[#223053]">Change Password</h2>
        <form action="/resetPasswordProfile" method="post">

            <!-- Container for the email input field -->
            <div class="mb-4 relative">
                <!-- Label for the email input field -->
                <label for="email" class="block mb-2 text-[#223053]">Email</label>
                <!-- Disabled input field for user's email, pre-filled and required for password reset -->
                <input type="email" id="email" name="email"
                    class="w-full px-4 py-2 rounded-lg bg-gray-200 text-zinc-400" placeholder="email@example.com"
                    value="<%= email %>" required disabled />
            </div>

            <!-- Container for the new password input field -->
            <div class="mb-4 relative">
                <!-- Label for the new password input field -->
                <label for="password" class="block mb-2 text-[#223053]">New Password</label>
                <!-- Flex container for password input and toggle button -->
                <div class="flex items-center">
                    <!-- Input field for new password, required for password reset -->
                    <input type="password" id="password" name="password"
                        class="w-full px-4 py-2 rounded-lg bg-white text-zinc-900" placeholder="Enter new password"
                        required />
                    <!-- Button to toggle password visibility -->
                    <button id="togglePassword" type="button"
                        class="ml-2 bg-transparent border-none text-[#515F84] cursor-pointer">
                        <!-- Icon for toggling password visibility -->
                        <span id="toggleIcon" class="material-symbols-outlined">visibility_off</span>
                    </button>
                </div>
            </div>

            <!-- Container for the confirm new password input field -->
            <div class="mb-4 relative">
                <!-- Lable for the new password input field -->
                <label for="confirmPassword" class="block mb-2 text-[#223053]">Confirm New Password</label>
                <!-- Flex container for confirm password input and toggle button -->
                <div class="flex items-center">
                    <!-- Input field for confirming new password, required for password reset -->
                    <input type="password" id="confirmPassword" name="confirmPassword"
                        class="w-full px-4 py-2 rounded-lg bg-white text-zinc-900" placeholder="Confirm new password"
                        required />
                    <!-- Button to toggle password visibility -->
                    <button id="toggleConfirmPassword" type="button"
                        class="ml-2 bg-transparent border-none text-[#515F84] cursor-pointer">
                        <!-- Icon for toggling confirm password visibility -->
                        <span id="toggleIconConfirm" class="material-symbols-outlined">visibility_off</span>
                    </button>
                </div>
            </div>
            <!-- Error message for password mismatch, hidden by default -->
            <span id="passwordError" class="error text-red-600" style="display: none">Passwords do not match.</span>
            <br />

            <!-- Submit button for the form -->
            <button type="submit" class="w-full bg-[#515F84] text-white py-2 rounded-lg">
                Change Password
            </button>
        </form>
    </div>

    <script>
        // Get the new password input element
        const passwordInput = document.getElementById("password");

        // Get the confirm password input element
        const confirmPasswordInput =
            document.getElementById("confirmPassword");

        // Get the toggle password button for new password visibility
        const toggleButton = document.getElementById("togglePassword");

        // Get the icon element inside the toggle button
        const toggleIcon = document.getElementById("toggleIcon");

        // Get the toggle button for confirm password visibility
        const toggleConfirmButton = document.getElementById(
            "toggleConfirmPassword"
        );

        // Get the icon element inside the toggle confirm button
        const toggleIconConfirm =
            document.getElementById("toggleIconConfirm");

        // Get the error message for password mismatch
        const passwordError = document.getElementById("passwordError");

        // Event listener for the password visibility toggle button
        toggleButton.addEventListener("click", () => {
            // Check if the passowrd input field is of type password
            if (passwordInput.type === "password") {
                // Change the input type to text to show the password
                passwordInput.type = "text";
                // Change the icon to visibility
                toggleIcon.textContent = "visibility";
            }
            // If the input type is not password
            else {
                // Change the input type to password to hide the password
                passwordInput.type = "password";
                // Change the icon to visibility_off
                toggleIcon.textContent = "visibility_off";
            }
        });

        // Event listener for the confirm password visibility toggle button
        toggleConfirmButton.addEventListener("click", () => {
            // Check if the confirm password input field is of type password
            if (confirmPasswordInput.type === "password") {
                // Change the input type to text to show the password
                confirmPasswordInput.type = "text";
                // Change the icon to visibility
                toggleIconConfirm.textContent = "visibility";
            }
            // If the input type is not password
            else {
                // Change the input type to password to hide the password
                confirmPasswordInput.type = "password";
                // Change the icon to visibility_off
                toggleIconConfirm.textContent = "visibility_off";
            }
        });

        // Event listener for the confirm password input field
        confirmPasswordInput.addEventListener("input", () => {
            // Check if the password and confirm password fields match
            if (passwordInput.value !== confirmPasswordInput.value) {
                // Display the error message
                passwordError.style.display = "inline";
            }
            // If the password and confirm password values match
            else {
                // Hide the error message
                passwordError.style.display = "none";
            }
        });
    </script>
</body>

</html>